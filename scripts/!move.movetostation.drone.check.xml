<?xml version="1.0" standalone="yes" ?>
<?xml-stylesheet href="x2script.xsl" type="text/xsl" ?>
<script>
<name>!move.movetostation.drone.check</name>
<version>1</version>
<engineversion>73</engineversion>
<description>Disables collision on drone when close to target ship.</description>
<arguments>
<argument index="1" name="target" type="Var/Ship" desc="" />
<argument index="2" name="range" type="Var/Number" desc="" />
<argument index="3" name="task" type="Var/Number" desc="task assigned to movetoposition" />
</arguments>
<sourceplaintext>
<![CDATA[
  skip if $target
    return null
  $distLongWait = $range * 2
  $distVeryLongWait = $range * 3
  while $target -> exists
    skip if [THIS] -> is script !move.movetostation.drone on stack of task=0
      break
    if not [THIS] -> is in active sector
      [THIS] ->ignore collisions: [FALSE]
@     = wait 60000 ms
      continue
    else if not $target -> is in active sector
      [THIS] ->ignore collisions: [FALSE]
@     = wait 60000 ms
      continue
    end
    
    $dist = get distance between [THIS] and $target
    if $dist < $range
      if not [THIS] -> find nearest enemy ship: max.dist=10000
        [THIS] ->ignore collisions: [TRUE]
@       = wait 5000 ms
        continue
      end
    end
    [THIS] ->ignore collisions: [FALSE]
    if $dist > $distVeryLongWait
@     = wait 10000 ms
    else if $dist > $distLongWait
@     = wait 5000 ms
    else
@     = wait 1000 ms
    end
  end
  
@ = wait 500 ms
  [THIS] ->ignore collisions: [FALSE]
  if [THIS] -> is script !move.movetopositioncontinue on stack of task=$task
    [THIS] ->start task $task with script !lib.interrupt and prio 100: arg1=null arg2=null arg3=null arg4=null arg5=null
  else if [THIS] -> is script !move.movetoposition on stack of task=$task
    [THIS] ->start task $task with script !lib.interrupt and prio 100: arg1=null arg2=null arg3=null arg4=null arg5=null
  end
  return null
]]>
</sourceplaintext>
<sourcetext>
<line indent=""><var>skip&#160;if&#160;</var><var>$target</var></line>
<line indent="&#160;"><text>return&#160;</text><var>null</var></line>
<line indent=""><var>$distLongWait&#160;=&#160;</var><var>$range</var><text>&#160;</text><var>*</var><text>&#160;</text><var>2</var></line>
<line indent=""><var>$distVeryLongWait&#160;=&#160;</var><var>$range</var><text>&#160;</text><var>*</var><text>&#160;</text><var>3</var></line>
<line indent=""><var>while&#160;</var><var>$target&#160;-&gt;</var><text>&#160;exists</text></line>
<line indent="&#160;"><var>skip&#160;if&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;is&#160;script&#160;</text><call>!move.movetostation.drone</call><text>&#160;on&#160;stack&#160;of&#160;task=</text><var>0</var></line>
<line indent="&#160;&#160;"><text>break</text></line>
<line indent="&#160;"><var>if&#160;not&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;is&#160;in&#160;active&#160;sector</text></line>
<line indent="&#160;&#160;"><var>[THIS]&#160;-&gt;</var><text>ignore&#160;collisions:&#160;</text><var>[FALSE]</var></line>
<line interruptable="@" indent="&#160;&#160;"><var>=&#160;</var><text>wait&#160;</text><var>60000</var><text>&#160;ms</text></line>
<line indent="&#160;&#160;"><text>continue</text></line>
<line indent="&#160;"><var>else&#160;if&#160;not&#160;</var><var>$target&#160;-&gt;</var><text>&#160;is&#160;in&#160;active&#160;sector</text></line>
<line indent="&#160;&#160;"><var>[THIS]&#160;-&gt;</var><text>ignore&#160;collisions:&#160;</text><var>[FALSE]</var></line>
<line interruptable="@" indent="&#160;&#160;"><var>=&#160;</var><text>wait&#160;</text><var>60000</var><text>&#160;ms</text></line>
<line indent="&#160;&#160;"><text>continue</text></line>
<line indent="&#160;"><text>end</text></line>
<line indent="&#160;"></line>
<line indent="&#160;"><var>$dist&#160;=&#160;</var><text>get&#160;distance&#160;between&#160;</text><var>[THIS]</var><text>&#160;and&#160;</text><var>$target</var></line>
<line indent="&#160;"><var>if&#160;</var><var>$dist</var><text>&#160;</text><var>&lt;</var><text>&#160;</text><var>$range</var></line>
<line indent="&#160;&#160;"><var>if&#160;not&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;find&#160;nearest&#160;enemy&#160;ship:&#160;max.dist=</text><var>10000</var></line>
<line indent="&#160;&#160;&#160;"><var>[THIS]&#160;-&gt;</var><text>ignore&#160;collisions:&#160;</text><var>[TRUE]</var></line>
<line interruptable="@" indent="&#160;&#160;&#160;"><var>=&#160;</var><text>wait&#160;</text><var>5000</var><text>&#160;ms</text></line>
<line indent="&#160;&#160;&#160;"><text>continue</text></line>
<line indent="&#160;&#160;"><text>end</text></line>
<line indent="&#160;"><text>end</text></line>
<line indent="&#160;"><var>[THIS]&#160;-&gt;</var><text>ignore&#160;collisions:&#160;</text><var>[FALSE]</var></line>
<line indent="&#160;"><var>if&#160;</var><var>$dist</var><text>&#160;</text><var>&gt;</var><text>&#160;</text><var>$distVeryLongWait</var></line>
<line interruptable="@" indent="&#160;&#160;"><var>=&#160;</var><text>wait&#160;</text><var>10000</var><text>&#160;ms</text></line>
<line indent="&#160;"><var>else&#160;if&#160;</var><var>$dist</var><text>&#160;</text><var>&gt;</var><text>&#160;</text><var>$distLongWait</var></line>
<line interruptable="@" indent="&#160;&#160;"><var>=&#160;</var><text>wait&#160;</text><var>5000</var><text>&#160;ms</text></line>
<line indent="&#160;"><text>else</text></line>
<line interruptable="@" indent="&#160;&#160;"><var>=&#160;</var><text>wait&#160;</text><var>1000</var><text>&#160;ms</text></line>
<line indent="&#160;"><text>end</text></line>
<line indent=""><text>end</text></line>
<line indent=""></line>
<line interruptable="@" indent=""><var>=&#160;</var><text>wait&#160;</text><var>500</var><text>&#160;ms</text></line>
<line indent=""><var>[THIS]&#160;-&gt;</var><text>ignore&#160;collisions:&#160;</text><var>[FALSE]</var></line>
<line indent=""><var>if&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;is&#160;script&#160;</text><call>!move.movetopositioncontinue</call><text>&#160;on&#160;stack&#160;of&#160;task=</text><var>$task</var></line>
<line indent="&#160;"><var>[THIS]&#160;-&gt;</var><text>start&#160;task&#160;</text><var>$task</var><text>&#160;with&#160;script&#160;</text><call>!lib.interrupt</call><text>&#160;and&#160;prio&#160;</text><var>100</var><text>:&#160;arg1=</text><var>null</var><text>&#160;arg2=</text><var>null</var><text>&#160;arg3=</text><var>null</var><text>&#160;arg4=</text><var>null</var><text>&#160;arg5=</text><var>null</var></line>
<line indent=""><var>else&#160;if&#160;</var><var>[THIS]&#160;-&gt;</var><text>&#160;is&#160;script&#160;</text><call>!move.movetoposition</call><text>&#160;on&#160;stack&#160;of&#160;task=</text><var>$task</var></line>
<line indent="&#160;"><var>[THIS]&#160;-&gt;</var><text>start&#160;task&#160;</text><var>$task</var><text>&#160;with&#160;script&#160;</text><call>!lib.interrupt</call><text>&#160;and&#160;prio&#160;</text><var>100</var><text>:&#160;arg1=</text><var>null</var><text>&#160;arg2=</text><var>null</var><text>&#160;arg3=</text><var>null</var><text>&#160;arg4=</text><var>null</var><text>&#160;arg5=</text><var>null</var></line>
<line indent=""><text>end</text></line>
<line indent=""><text>return&#160;</text><var>null</var></line>
</sourcetext>
<codearray>

<sval type="array" size="10">
  <sval type="string" val="!move.movetostation.drone.check"/>
  <sval type="int" val="73"/>
  <sval type="string" val="Disables collision on drone when close to target ship."/>
  <sval type="int" val="1"/>
  <sval type="int" val="0"/>
  <sval type="array" size="6">
    <sval type="string" val="target"/>
    <sval type="string" val="range"/>
    <sval type="string" val="task"/>
    <sval type="string" val="distLongWait"/>
    <sval type="string" val="distVeryLongWait"/>
    <sval type="string" val="dist"/>
  </sval>
  <sval type="array" size="39">
    <sval type="array" size="7">
      <sval type="int" val="104"/>
      <sval type="int" val="-536870393"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-1"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="3"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="1"/>
      <sval type="int" val="4"/>
      <sval type="int" val="2"/>
      <sval type="int" val="15"/>
      <sval type="int" val="13"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="13"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="4"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="1"/>
      <sval type="int" val="4"/>
      <sval type="int" val="3"/>
      <sval type="int" val="15"/>
      <sval type="int" val="13"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="13"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="706"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-1610604791"/>
    </sval>
    <sval type="array" size="7">
      <sval type="int" val="1072"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-536869113"/>
      <sval type="string" val="!move.movetostation.drone"/>
      <sval type="int" val="4"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="112"/>
      <sval type="int" val="31"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="761"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-536867836"/>
    </sval>
    <sval type="array" size="5">
      <sval type="int" val="1221"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="9"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="105"/>
      <sval type="int" val="-2147483647"/>
      <sval type="int" val="4"/>
      <sval type="int" val="60000"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="112"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="112"/>
      <sval type="int" val="16"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="761"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
      <sval type="int" val="-536866810"/>
    </sval>
    <sval type="array" size="5">
      <sval type="int" val="1221"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="9"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="105"/>
      <sval type="int" val="-2147483647"/>
      <sval type="int" val="4"/>
      <sval type="int" val="60000"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="112"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="738"/>
      <sval type="int" val="5"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610607101"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="5"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="1"/>
      <sval type="int" val="15"/>
      <sval type="int" val="3"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="6">
      <sval type="int" val="503"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-536865276"/>
      <sval type="int" val="4"/>
      <sval type="int" val="10000"/>
    </sval>
    <sval type="array" size="5">
      <sval type="int" val="1221"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="10"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="105"/>
      <sval type="int" val="-2147483647"/>
      <sval type="int" val="4"/>
      <sval type="int" val="5000"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="112"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="5">
      <sval type="int" val="1221"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="9"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610606077"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="5"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="4"/>
      <sval type="int" val="15"/>
      <sval type="int" val="2"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="2"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="105"/>
      <sval type="int" val="-2147483647"/>
      <sval type="int" val="4"/>
      <sval type="int" val="10000"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="112"/>
      <sval type="int" val="30"/>
    </sval>
    <sval type="array" size="13">
      <sval type="int" val="104"/>
      <sval type="int" val="-1610605307"/>
      <sval type="int" val="3"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="5"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="3"/>
      <sval type="int" val="15"/>
      <sval type="int" val="2"/>
      <sval type="int" val="3"/>
      <sval type="int" val="-1"/>
      <sval type="int" val="2"/>
      <sval type="int" val="-2"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="105"/>
      <sval type="int" val="-2147483647"/>
      <sval type="int" val="4"/>
      <sval type="int" val="5000"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="112"/>
      <sval type="int" val="30"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="105"/>
      <sval type="int" val="-2147483647"/>
      <sval type="int" val="4"/>
      <sval type="int" val="1000"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="112"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="4">
      <sval type="int" val="105"/>
      <sval type="int" val="-2147483647"/>
      <sval type="int" val="4"/>
      <sval type="int" val="500"/>
    </sval>
    <sval type="array" size="5">
      <sval type="int" val="1221"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="9"/>
    </sval>
    <sval type="array" size="7">
      <sval type="int" val="1072"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-1610603517"/>
      <sval type="string" val="!move.movetopositioncontinue"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="18">
      <sval type="int" val="1017"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="string" val="!lib.interrupt"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="2"/>
      <sval type="int" val="4"/>
      <sval type="int" val="100"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="112"/>
      <sval type="int" val="38"/>
    </sval>
    <sval type="array" size="7">
      <sval type="int" val="1072"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="int" val="-1610603003"/>
      <sval type="string" val="!move.movetoposition"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="18">
      <sval type="int" val="1017"/>
      <sval type="int" val="131075"/>
      <sval type="int" val="1"/>
      <sval type="string" val="!lib.interrupt"/>
      <sval type="int" val="131074"/>
      <sval type="int" val="2"/>
      <sval type="int" val="4"/>
      <sval type="int" val="100"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
    <sval type="array" size="3">
      <sval type="int" val="103"/>
      <sval type="int" val="0"/>
      <sval type="int" val="0"/>
    </sval>
  </sval>
  <sval type="array" size="3">
    <sval type="array" size="2">
      <sval type="int" val="21"/>
      <sval type="string" val=""/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="10"/>
      <sval type="string" val=""/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="10"/>
      <sval type="string" val="task assigned to movetoposition"/>
    </sval>
  </sval>
  <sval type="array" size="13">
    <sval type="array" size="2">
      <sval type="int" val="7"/>
      <sval type="int" val="7"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="11"/>
      <sval type="int" val="6"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="16"/>
      <sval type="int" val="6"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="16"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="16"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="22"/>
      <sval type="int" val="6"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="22"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="22"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="29"/>
      <sval type="int" val="5"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="30"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="31"/>
      <sval type="int" val="4"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="31"/>
      <sval type="int" val="2"/>
    </sval>
    <sval type="array" size="2">
      <sval type="int" val="38"/>
      <sval type="int" val="4"/>
    </sval>
  </sval>
  <sval type="int" val="0"/>
</sval>

</codearray>
<nosignature>6465</nosignature>
</script>
